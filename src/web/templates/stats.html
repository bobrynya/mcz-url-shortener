{% extends "base.html" %}

{% block title %}–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Å—Å—ã–ª–∫–∏ - MCZ URL Shortener{% endblock %}

{% block breadcrumb %}
<div class="breadcrumb">
    <a href="/dashboard">–ì–ª–∞–≤–Ω–∞—è</a> / <a href="/dashboard/links">–°—Å—ã–ª–∫–∏</a> / –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
</div>
{% endblock %}

{% block header %}
<div class="header">
    <h1>üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Å—Å—ã–ª–∫–∏</h1>
    <div class="header-actions">
        <a href="/dashboard/links" class="btn btn-secondary">‚Üê –ö —Å–ø–∏—Å–∫—É</a>
        <a href="/dashboard" class="btn btn-secondary">Dashboard</a>
        <button onclick="MCZAuth.logout()" class="btn btn-danger btn-sm">
            üö™ –í—ã—Ö–æ–¥
        </button>
    </div>
</div>
{% endblock %}

{% block extra_styles %}
<script src="/static/js/echarts.min.js"></script>
{% endblock %}

{% block content %}
<!-- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Å—Å—ã–ª–∫–µ -->
<div class="card">
    <h2>–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Å—Å—ã–ª–∫–µ</h2>
    <div class="info-row">
        <div class="info-label">–ö–æ—Ä–æ—Ç–∫–∞—è —Å—Å—ã–ª–∫–∞:</div>
        <div class="info-value short-url">
            <a id="shortUrl" href="#" target="_blank"></a>
            <button id="copyBtn" class="btn btn-sm">üìã</button>
        </div>
    </div>
    <div class="info-row">
        <div class="info-label">–û—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–∞—è —Å—Å—ã–ª–∫–∞:</div>
        <div class="info-value">
            <a id="longUrl" href="#" target="_blank"></a>
        </div>
    </div>
    <div class="info-row">
        <div class="info-label">–î–æ–º–µ–Ω:</div>
        <div class="info-value">
            <code id="domain">‚Äî</code>
        </div>
    </div>
    <div class="info-row">
        <div class="info-label">–í—Å–µ–≥–æ –ø–µ—Ä–µ—Ö–æ–¥–æ–≤:</div>
        <div class="info-value" id="totalClicks">0</div>
    </div>
    <div class="info-row">
        <div class="info-label">–°–æ–∑–¥–∞–Ω–∞:</div>
        <div class="info-value" id="createdAt">‚Äî</div>
    </div>
</div>

<!-- –§–∏–ª—å—Ç—Ä—ã –ø–æ –≤—Ä–µ–º–µ–Ω–∏ -->
<div class="card">
    <h2>–ü–µ—Ä–∏–æ–¥ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏</h2>
    <div class="quick-filters">
        <button class="quick-filter-btn active" data-period="all" onclick="MCZStats.setQuickFilter('all')">
            –í—Å—ë –≤—Ä–µ–º—è
        </button>
        <button class="quick-filter-btn" data-period="today" onclick="MCZStats.setQuickFilter('today')">
            –°–µ–≥–æ–¥–Ω—è
        </button>
        <button class="quick-filter-btn" data-period="week" onclick="MCZStats.setQuickFilter('week')">
            –ù–µ–¥–µ–ª—è
        </button>
        <button class="quick-filter-btn" data-period="month" onclick="MCZStats.setQuickFilter('month')">
            –ú–µ—Å—è—Ü
        </button>
        <button class="quick-filter-btn" data-period="custom" onclick="MCZStats.toggleCustomPeriod()">
            –°–≤–æ–π –ø–µ—Ä–∏–æ–¥
        </button>
    </div>

    <div id="customPeriodForm" style="display: none; margin-top: 16px;">
        <div class="filters-row">
            <div class="filter-group">
                <label for="statsFromDate">–û—Ç –¥–∞—Ç—ã</label>
                <input type="datetime-local" id="statsFromDate">
            </div>
            <div class="filter-group">
                <label for="statsToDate">–î–æ –¥–∞—Ç—ã</label>
                <input type="datetime-local" id="statsToDate">
            </div>
            <div class="filter-group" style="align-self: end;">
                <button class="btn" onclick="MCZStats.applyCustomPeriod()">–ü—Ä–∏–º–µ–Ω–∏—Ç—å</button>
            </div>
        </div>
    </div>
</div>

<!-- –ì—Ä–∞—Ñ–∏–∫ –∫–ª–∏–∫–æ–≤ –ø–æ –≤—Ä–µ–º–µ–Ω–∏ -->
<div class="card">
    <h2>–ö–ª–∏–∫–∏ –ø–æ –≤—Ä–µ–º–µ–Ω–∏</h2>
    <div id="clicksChart" style="min-height: 400px;"></div>
</div>

<!-- –¢–∞–±–ª–∏—Ü–∞ –∫–ª–∏–∫–æ–≤ -->
<div class="card">
    <h2>–î–µ—Ç–∞–ª—å–Ω–∞—è –∏—Å—Ç–æ—Ä–∏—è –ø–µ—Ä–µ—Ö–æ–¥–æ–≤</h2>
    <div id="clicksTable">
        <div class="loading">–ó–∞–≥—Ä—É–∑–∫–∞...</div>
    </div>
</div>

<!-- –ü–∞–≥–∏–Ω–∞—Ü–∏—è -->
<div id="pagination"></div>
{% endblock %}

{% block extra_scripts %}
<script>
    document.addEventListener('DOMContentLoaded', () => {
        const code = '{{ code }}';
        MCZStats.init(code);
    });
</script>
{% endblock %}
